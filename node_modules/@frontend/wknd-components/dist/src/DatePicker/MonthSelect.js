"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var react_1 = __importDefault(require("react"));
var date_fns_1 = require("date-fns");
var getYear_1 = __importDefault(require("date-fns/getYear"));
var set_1 = __importDefault(require("date-fns/set"));
var subMonths_1 = __importDefault(require("date-fns/subMonths"));
var Select_1 = require("../Select");
var getMonthsArray = function (minDate, maxDate, currentSelectedYear, monthNames) {
    if ((0, getYear_1.default)(minDate) === currentSelectedYear && (0, getYear_1.default)(maxDate) === currentSelectedYear) {
        return monthNames.slice((0, date_fns_1.getMonth)(minDate), (0, date_fns_1.getMonth)(maxDate) + 1);
    }
    if ((0, getYear_1.default)(minDate) === currentSelectedYear) {
        return monthNames.slice((0, date_fns_1.getMonth)(minDate));
    }
    if ((0, getYear_1.default)(maxDate) === currentSelectedYear) {
        return monthNames.slice(undefined, (0, date_fns_1.getMonth)(maxDate) + 1);
    }
    return monthNames;
};
var MonthSelect = function (_a) {
    var dataQA = _a.dataQA, month = _a.month, monthNames = _a.monthNames, calendarIndex = _a.calendarIndex, setDate = _a.setDate, calendarOffset = _a.calendarOffset, setCalendarOffset = _a.setCalendarOffset, currentSelectedYear = _a.currentSelectedYear, minDate = _a.minDate, maxDate = _a.maxDate;
    var monthsToShow = getMonthsArray(minDate, maxDate, currentSelectedYear, monthNames);
    var handleOnChange = function (event) {
        // this will set the calendar at index 0, so we have to take into account the index of the calendar that is being adjusted
        var selectedMonthPosition = monthNames === null || monthNames === void 0 ? void 0 : monthNames.indexOf(event.target.value);
        var selectedMonth = (0, set_1.default)(new Date(), { month: selectedMonthPosition, year: currentSelectedYear });
        // index of monthNames is one less than calendar month
        var firstCalDate = (0, subMonths_1.default)(selectedMonth, calendarIndex);
        setDate(firstCalDate);
        if (calendarOffset > 0 || calendarOffset < 0) {
            setCalendarOffset(0);
        }
    };
    return (react_1.default.createElement(Select_1.Select, { dataQA: "".concat(dataQA, "-month-select"), onChange: handleOnChange, value: monthNames[month], name: "month-select", "aria-label": "select a month" }, monthNames.map(function (monthName) { return (react_1.default.createElement("option", { value: monthName, key: "".concat(monthName, "-").concat(calendarIndex, "-").concat(dataQA), 
        // hide options that are not in the monthsToShow array
        hidden: !monthsToShow.includes(monthName), "data-qa": "".concat(dataQA, "-").concat(monthName, "-month-option") }, monthName)); })));
};
exports.default = MonthSelect;
//# sourceMappingURL=MonthSelect.js.map