{"version":3,"file":"DateButton.js","sourceRoot":"","sources":["../../../src/DatePicker/DateButton.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAA,gDAA0B;AAC1B,iEAA2C;AAC3C,iCAAiE;AAEjE,wEAAkD;AAElD,yDAG6B;AAE7B,qCAAoC;AAWpC,IAAM,0BAA0B,GAAG,UAAC,iBAAyB,EAAE,eAAuB;IACrF,IAAI,iBAAiB,GAAG,eAAe,EAAE;QACxC,OAAO,YAAY,CAAC;KACpB;IACD,IAAI,iBAAiB,GAAG,eAAe,EAAE;QACxC,OAAO,UAAU,CAAC;KAClB;IACD,OAAO;AACR,CAAC,CAAC;AAEF,IAAM,uBAAuB,GAAG,UAC/B,iBAAyB,EACzB,kBAA0B,EAC1B,YAAoB;IAEpB,IAAI,iBAAiB,KAAK,kBAAkB;QAC3C,IAAA,mBAAS,EAAC,iBAAiB,EAAE,kBAAkB,CAAC,EAC/C;QACD,OAAO;KACP;IAED,IAAI,iBAAiB,KAAK,YAAY,EAAE;QACvC,OAAO,YAAY,CAAC;KACpB;IAED,IAAI,kBAAkB,KAAK,YAAY,EAAE;QACxC,OAAO,UAAU,CAAC;KAClB;IAED,OAAO;AACR,CAAC,CAAC;AAEF,IAAM,uBAAuB,GAAG,UAC/B,OAAgB,EAChB,WAAwB,EACxB,QAAwB;IAExB,IAAI,CAAC,CAAC,QAAQ,YAAY,KAAK,CAAC,IAAI,CAAC,CAAA,QAAQ,aAAR,QAAQ,uBAAR,QAAQ,CAAE,MAAM,CAAA,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE;QAC3E,OAAO;KACP;IAED,IAAM,iBAAiB,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC;IAEhD,IAAI,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;QAC1B,IAAM,kBAAkB,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC;QACjD,IAAM,YAAY,GAAG,OAAO,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;QAE5C,wCAAwC;QACxC,IAAI,IAAA,mBAAS,EAAC,iBAAiB,EAAE,kBAAkB,CAAC,IAAI,WAAW,EAAE;YACpE,IAAM,eAAe,GAAG,WAAW,aAAX,WAAW,uBAAX,WAAW,CAAE,OAAO,EAAE,CAAC;YAC/C,OAAO,0BAA0B,CAAC,iBAAiB,EAAE,eAAe,CAAC,CAAC;SACtE;aAAM;YACN,OAAO,uBAAuB,CAAC,iBAAiB,EAAE,kBAAkB,EAAE,YAAY,CAAC,CAAC;SACpF;KACD;IAED,OAAO;AACR,CAAC,CAAC;AAEK,IAAM,UAAU,GAAG,UAAC,EAOT;QANjB,WAAW,iBAAA,EACX,OAAO,aAAA,EACP,SAAS,eAAA,EACT,WAAW,iBAAA,EACX,OAAO,aAAA,EACP,gBAAa,EAAb,QAAQ,mBAAG,CAAC,CAAC,KAAA;IAEL,IAAA,YAAY,GAAK,IAAA,kBAAS,EAAC,WAAW,CAAC,aAA3B,CAA4B;IACxC,IAAA,QAAQ,GAAK,WAAW,SAAhB,CAAiB;IACjC,IAAM,UAAU,GAAG,OAAO,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;IAE1C,IAAM,SAAS,GAAG,UAAC,IAAU;QAC5B,IAAI,CAAC,CAAC,QAAQ,YAAY,KAAK,CAAC,IAAI,CAAC,CAAA,QAAQ,aAAR,QAAQ,uBAAR,QAAQ,CAAE,MAAM,CAAA,EAAE;YACtD,OAAO,KAAK,CAAC;SACb;QAED,IAAI,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;YAC1B,OAAO,KAAK,CAAC;SACb;QAED,IAAM,aAAa,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC;QAC5C,IAAM,YAAY,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC;QAEpC,IAAI,IAAA,mBAAS,EAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE;YACxC,IAAM,eAAe,GAAG,WAAW,aAAX,WAAW,uBAAX,WAAW,CAAE,OAAO,EAAE,CAAC;YAE/C,OAAO,CACN,eAAe,CAAC,CAAC,CAAC,CACjB,CAAC,aAAa,GAAG,YAAY,IAAI,eAAe,IAAI,YAAY,CAAC;gBACjE,CAAC,YAAY,GAAG,aAAa,IAAI,YAAY,IAAI,eAAe,CAAC,CACjE,CAAC,CAAC,CAAC,KAAK,CACT,CAAC;SACF;aAAM;YACN,IAAM,cAAc,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC;YAE7C,OAAO,aAAa,GAAG,YAAY,IAAI,cAAc,GAAG,YAAY,CAAC;SACrE;IACF,CAAC,CAAC;IAEF,IAAM,YAAY,GAAG;QACpB,IAAI,OAAO,CAAC,KAAK,EAAE;YAClB,OAAQ,wBAAiB,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,CAAE,CAAC;SACvD;QACD,IAAI,OAAO,IAAI,QAAQ,YAAY,KAAK,KAAI,QAAQ,aAAR,QAAQ,uBAAR,QAAQ,CAAE,MAAM,CAAA,EAAE;YAC7D,IAAM,QAAQ,GAAG,OAAO,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;YACxC,IAAM,aAAa,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC;YAC5C,IAAM,cAAc,GAAG,QAAQ,CAAC,CAAC,CAAC,IAAI,QAAQ,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC;YAC5D,IAAI,aAAa,IAAI,cAAc,IAAI,CAAC,QAAQ,KAAK,aAAa,IAAI,QAAQ,KAAK,cAAc,CAAC,EAAE;gBACnG,mCAAmC;gBACnC,OAAO,kCAA2B,QAAQ,CAAC,CAAC,CAAC,CAAC,YAAY,EAAE,qCAA2B,QAAQ,CAAC,CAAC,CAAC,CAAC,YAAY,EAAE,CAAE,CAAC;aACpH;iBAAM,IAAI,aAAa,GAAG,QAAQ,IAAI,cAAc,GAAG,QAAQ,EAAE;gBACjE,OAAO,UAAG,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,cAAW,CAAC;aACjD;SAED;QACD,OAAO,OAAO,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC;IACpC,CAAC,CAAC;IAEF,OAAO,CACN,8BAAC,6CAAyB,IACzB,cAAc,EAAE,OAAO,CAAC,CAAC,CAAC,uBAAuB,CAAC,OAAO,EAAE,WAAW,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC,SAAS,EAC7F,UAAU,EAAE,OAAO,CAAC,QAAQ,EAC5B,GAAG,EAAE,UAAU,aACN,UAAG,UAAU,kCAA+B,EACrD,OAAO,EAAE,OAAO,CAAC,KAAK;QAEtB,8BAAC,sCAAkB,wBACT,UAAU,EACnB,GAAG,EAAE,UAAU,EACf,QAAQ,EAAE,OAAO,CAAC,QAAQ,EAC1B,SAAS,EAAE,OAAO,IAAI,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,mBAC9B,OAAO,CAAC,QAAQ,IAC3B,YAAY,CAAC,SAAS,CAAC,kBACf,YAAY,EAAE,EAC1B,QAAQ,EAAE,QAAQ,0BACG,sBAAsB;YAE3C,8BAAC,oBAAU,IACV,MAAM,EAAE,UAAG,UAAU,0BAAuB,EAC5C,SAAS,EAAC,MAAM,EAChB,OAAO,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,UAAU,IAEnD,UAAU,CACC;YACZ,OAAO,CAAC,KAAK;gBACb,8BAAC,iBAAO,IACP,SAAS,EAAE,OAAO,IAAI,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,EAC7C,QAAQ,EAAE,OAAO,CAAC,QAAQ,GACzB,CACiB,CACM,CAC5B,CAAC;AACH,CAAC,CAAC;AA7FW,QAAA,UAAU,cA6FrB","sourcesContent":["import React from \"react\";\nimport isSameDay from \"date-fns/isSameDay\";\nimport { DateObj, GetDatePropsOptions, useDayzed } from \"dayzed\";\n\nimport Typography from \"../Typography/Typography\";\n\nimport {\n\tCalendarDateButton,\n\tCalendarDateButtonWrapper,\n} from \"./DateButton.styles\";\nimport { StaticDatePickerProps } from \"./DatePicker.types\";\nimport { Ellipse } from \"./Ellipse\";\n\ntype DateButtonProps = Pick<StaticDatePickerProps, \"dayzedProps\" | \"isRange\"> & {\n\thoveredDate: Date | null;\n\tdateObj: DateObj;\n\tdateProps: GetDatePropsOptions;\n\ttabIndex?: number;\n};\n\nexport type RangePositions = \"rangeStart\" | \"rangeEnd\" | undefined;\n\nconst getPositionWithHoveredDate = (firstSelectedDate: number, hoveredDateTime: number): RangePositions => {\n\tif (firstSelectedDate < hoveredDateTime) {\n\t\treturn \"rangeStart\";\n\t}\n\tif (firstSelectedDate > hoveredDateTime) {\n\t\treturn \"rangeEnd\";\n\t}\n\treturn;\n};\n\nconst getPositionWithTwoDates = (\n\tfirstSelectedDate: number,\n\tsecondSelectedDate: number,\n\tselectedDate: number,\n): RangePositions => {\n\tif (firstSelectedDate === secondSelectedDate ||\n\t\tisSameDay(firstSelectedDate, secondSelectedDate)\n\t) {\n\t\treturn;\n\t}\n\n\tif (firstSelectedDate === selectedDate) {\n\t\treturn \"rangeStart\";\n\t}\n\n\tif (secondSelectedDate === selectedDate) {\n\t\treturn \"rangeEnd\";\n\t}\n\n\treturn;\n};\n\nconst getSelectedDatePosition = (\n\tdateObj: DateObj,\n\thoveredDate: Date | null,\n\tselected?: Date | Date[],\n): RangePositions => {\n\tif (!(selected instanceof Array) || !selected?.length || !dateObj.selected) {\n\t\treturn;\n\t}\n\n\tconst firstSelectedDate = selected[0].getTime();\n\n\tif (selected.length === 2) {\n\t\tconst secondSelectedDate = selected[1].getTime();\n\t\tconst selectedDate = dateObj.date.getTime();\n\n\t\t// we can assume a new date was selected\n\t\tif (isSameDay(firstSelectedDate, secondSelectedDate) && hoveredDate) {\n\t\t\tconst hoveredDateTime = hoveredDate?.getTime();\n\t\t\treturn getPositionWithHoveredDate(firstSelectedDate, hoveredDateTime);\n\t\t} else {\n\t\t\treturn getPositionWithTwoDates(firstSelectedDate, secondSelectedDate, selectedDate);\n\t\t}\n\t}\n\n\treturn;\n};\n\nexport const DateButton = ({\n\thoveredDate,\n\tdateObj,\n\tdateProps,\n\tdayzedProps,\n\tisRange,\n\ttabIndex = -1, //the element is not reachable via sequential keyboard navigation\n}: DateButtonProps) => {\n\tconst { getDateProps } = useDayzed(dayzedProps);\n\tconst { selected } = dayzedProps;\n\tconst buttonDate = dateObj.date.getDate();\n\n\tconst isInRange = (date: Date) => {\n\t\tif (!(selected instanceof Array) || !selected?.length) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (selected.length !== 2) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst firstSelected = selected[0].getTime();\n\t\tconst selectedDate = date.getTime();\n\n\t\tif (isSameDay(selected[0], selected[1])) {\n\t\t\tconst hoveredDateTime = hoveredDate?.getTime();\n\n\t\t\treturn (\n\t\t\t\thoveredDateTime ? (\n\t\t\t\t\t(firstSelected < selectedDate && hoveredDateTime >= selectedDate) ||\n\t\t\t\t\t(selectedDate < firstSelected && selectedDate >= hoveredDateTime)\n\t\t\t\t) : false\n\t\t\t);\n\t\t} else {\n\t\t\tconst secondSelected = selected[1].getTime();\n\n\t\t\treturn firstSelected < selectedDate && secondSelected > selectedDate;\n\t\t}\n\t};\n\n\tconst getAriaLabel = () => {\n\t\tif (dateObj.today) {\n\t\t\treturn  `Today's Date, ${dateObj.date.toDateString()}`;\n\t\t}\n\t\tif (isRange && selected instanceof Array && selected?.length) {\n\t\t\tconst dateTime = dateObj.date.getTime();\n\t\t\tconst firstSelected = selected[0].getTime();\n\t\t\tconst secondSelected = selected[1] && selected[1].getTime();\n\t\t\tif (firstSelected && secondSelected && (dateTime === firstSelected || dateTime === secondSelected)) {\n\t\t\t\t// eslint-disable-next-line max-len\n\t\t\t\treturn `Selected start of range ${selected[0].toDateString()}, selected end of range ${selected[1].toDateString()}`;\n\t\t\t} else if (firstSelected < dateTime && secondSelected > dateTime) {\n\t\t\t\treturn `${dateObj.date.toDateString()} selected`;\n\t\t\t}\n\n\t\t}\n\t\treturn dateObj.date.toDateString();\n\t};\n\n\treturn (\n\t\t<CalendarDateButtonWrapper\n\t\t\tbuttonSelected={isRange ? getSelectedDatePosition(dateObj, hoveredDate, selected) : undefined}\n\t\t\tisSelected={dateObj.selected}\n\t\t\tkey={buttonDate}\n\t\t\tdata-qa={`${buttonDate}-calendar-date-button-wrapper`}\n\t\t\tisToday={dateObj.today}\n\t\t>\n\t\t\t<CalendarDateButton\n\t\t\t\tdata-qa={buttonDate}\n\t\t\t\tkey={buttonDate}\n\t\t\t\tselected={dateObj.selected}\n\t\t\t\tisInRange={isRange && isInRange(dateObj.date)}\n\t\t\t\tdata-selected={dateObj.selected}\n\t\t\t\t{...getDateProps(dateProps)}\n\t\t\t\taria-label={getAriaLabel()}\n\t\t\t\ttabIndex={tabIndex}\n\t\t\t\tdata-calendar-button=\"calendar-date-button\"\n\t\t\t>\n\t\t\t\t<Typography\n\t\t\t\t\tdataQA={`${buttonDate}-calendar-button-text`}\n\t\t\t\t\tcomponent=\"span\"\n\t\t\t\t\tvariant={dateObj.today ? \"bodyCopyBold\" : \"bodyCopy\"}\n\t\t\t\t>\n\t\t\t\t\t{buttonDate}\n\t\t\t\t</Typography>\n\t\t\t\t{dateObj.today &&\n\t\t\t\t\t<Ellipse\n\t\t\t\t\t\tisInRange={isRange && isInRange(dateObj.date)}\n\t\t\t\t\t\tselected={dateObj.selected}\n\t\t\t\t\t/>}\n\t\t\t</CalendarDateButton>\n\t\t</CalendarDateButtonWrapper>\n\t);\n};\n"]}