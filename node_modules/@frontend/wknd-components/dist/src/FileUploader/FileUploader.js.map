{"version":3,"file":"FileUploader.js","sourceRoot":"","sources":["../../../src/FileUploader/FileUploader.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { ChangeEvent, DragEvent, MouseEvent, useRef, useState } from \"react\";\nimport attrAccept from \"attr-accept\";\n\nimport { Icon } from \"../Icon/Icon\";\nimport { colors, spacingMap } from \"../styleguide\";\nimport Typography from \"../Typography/Typography\";\n\nimport {\n\tDragFileElement,\n\tErrorMessageWrapper,\n\tFileUploaderInput,\n\tFileUploaderTitle,\n\tFileUploaderWrapper,\n\tStyledUploaderWrapper,\n\tUploadButton,\n} from \"./FileUploader.styles\";\nimport { FileUploaderProps } from \"./FileUploader.types\";\n\nconst isAcceptedFileType = (files: FileList, accept?: string) => {\n\tif (accept) {\n\t\t// for now we are only allowing single file upload but this could change in the future which\n\t\t// will change how the validation happens\n\t\treturn attrAccept({ name: files[0].name, type: files[0].type }, accept);\n\t}\n\n\treturn true;\n};\n\nconst FileUploader = ({\n\tonDrop,\n\tonChange,\n\tisDisabled = false,\n\tsubtitle,\n\tdataQA,\n\taccept,\n\terrorMessage,\n\t...props\n}: FileUploaderProps) => {\n\tconst [dragActive, setDragActive] = useState(false);\n\tconst [showValidationError, setShowValidationError] = useState(false);\n\tconst [uploadButtonIsFocused, setUploadButtonIsFocused] = useState(false);\n\n\tconst inputRef = useRef<HTMLInputElement>(null);\n\n\tconst handleClick = (event: MouseEvent<HTMLElement>) => {\n\t\tevent.stopPropagation();\n\t\tif (isDisabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (inputRef.current) {\n\t\t\tinputRef.current.click();\n\t\t\tinputRef.current.value = \"\";\n\t\t}\n\t};\n\n\tconst handleDragOver = (event: DragEvent<HTMLDivElement>) => {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tif (isDisabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.type === \"dragenter\" || event.type === \"dragover\") {\n\t\t\tsetDragActive(true);\n\t\t\t// reset validation error when dragging new file\n\t\t\tif (showValidationError) {\n\t\t\t\tsetShowValidationError(false);\n\t\t\t}\n\t\t} else if (event.type === \"dragleave\") {\n\t\t\tsetDragActive(false);\n\t\t}\n\t};\n\n\tconst handleDrop = (event: DragEvent<HTMLDivElement>) => {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tsetDragActive(false);\n\n\t\tif (isAcceptedFileType(event.dataTransfer.files, accept)) {\n\t\t\tsetShowValidationError(false);\n\t\t\tonDrop(event);\n\t\t} else {\n\t\t\tsetShowValidationError(true);\n\t\t\tonDrop(null);\n\t\t}\n\t};\n\n\tconst handleOnChange = (event: ChangeEvent<HTMLInputElement>) => {\n\t\tsetShowValidationError(false);\n\t\tonChange(event);\n\t};\n\n\tconst getIconColor = () => {\n\t\tif (isDisabled) {\n\t\t\treturn colors.darkerGray;\n\t\t}\n\n\t\tif (dragActive) {\n\t\t\treturn colors.midBlue;\n\t\t}\n\n\t\treturn colors.black;\n\t};\n\n\tlet uploadButtonAriaLabel = \"Click to upload or drag and drop files\";\n\n\tif (accept) {\n\t\tuploadButtonAriaLabel = `${uploadButtonAriaLabel}, supports ${accept.split(\",\").join(\", \")}`;\n\t}\n\n\treturn (\n\t\t<FileUploaderWrapper m={props.m} mb={props.mb} ml={props.ml} mr={props.mr} mt={props.mt} {...props}>\n\t\t\t<StyledUploaderWrapper\n\t\t\t\tdragActive={dragActive}\n\t\t\t\tuploadButtonIsFocused={uploadButtonIsFocused}\n\t\t\t\tonClick={handleClick}\n\t\t\t\tonDragEnter={handleDragOver}\n\t\t\t\tisDisabled={isDisabled}\n\t\t\t\tdata-qa={dataQA}\n\t\t\t\tshowValidationError={showValidationError}\n\t\t\t>\n\t\t\t\t<FileUploaderInput\n\t\t\t\t\tdata-qa={`${dataQA}-file-upload-input`}\n\t\t\t\t\ttype=\"file\"\n\t\t\t\t\tref={inputRef}\n\t\t\t\t\tonChange={handleOnChange}\n\t\t\t\t\taccept={accept}\n\t\t\t\t\tdisabled={isDisabled}\n\t\t\t\t\taria-describedby=\"file upload\"\n\t\t\t\t/>\n\t\t\t\t<Icon name=\"Upload\" size={20} color={getIconColor()} />\n\t\t\t\t<FileUploaderTitle>\n\t\t\t\t\t<UploadButton\n\t\t\t\t\t\tdataQA={`${dataQA}-upload-button`}\n\t\t\t\t\t\tbuttonText=\"Click to Upload\"\n\t\t\t\t\t\taria-label={uploadButtonAriaLabel}\n\t\t\t\t\t\tonClick={handleClick}\n\t\t\t\t\t\tdisabled={isDisabled}\n\t\t\t\t\t\tonFocus={() => setUploadButtonIsFocused(true)}\n\t\t\t\t\t\tonBlur={() => setUploadButtonIsFocused(false)}\n\t\t\t\t\t/>\n\t\t\t\t\t<Typography\n\t\t\t\t\t\tdataQA=\"drag-and-drop-text\"\n\t\t\t\t\t\tvariant=\"bodyCopyBold\"\n\t\t\t\t\t\tcomponent=\"span\"\n\t\t\t\t\t\tcolor={isDisabled ? `${colors.black}A8` : colors.black}\n\t\t\t\t\t>\n\t\t\t\t\t\tor drag and drop files\n\t\t\t\t\t</Typography>\n\t\t\t\t</FileUploaderTitle>\n\t\t\t\t{subtitle && (\n\t\t\t\t\t<Typography\n\t\t\t\t\t\tdataQA=\"file-uploader-subtitle\"\n\t\t\t\t\t\tmt={spacingMap.xxs}\n\t\t\t\t\t\tvariant=\"caption\"\n\t\t\t\t\t\tcolor={`${colors.black}A8`}\n\t\t\t\t\t>\n\t\t\t\t\t\t{subtitle}\n\t\t\t\t\t</Typography>\n\t\t\t\t)}\n\t\t\t\t{dragActive &&\n\t\t\t\t\t<DragFileElement\n\t\t\t\t\t\tdata-qa=\"file-uploader-drag-file-element\"\n\t\t\t\t\t\tonDragEnter={handleDragOver}\n\t\t\t\t\t\tonDragLeave={handleDragOver}\n\t\t\t\t\t\tonDragOver={handleDragOver}\n\t\t\t\t\t\tonDrop={handleDrop}\n\t\t\t\t\t/>\n\t\t\t\t}\n\t\t\t</StyledUploaderWrapper>\n\t\t\t<ErrorMessageWrapper aria-live=\"polite\">\n\t\t\t\t{showValidationError && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Icon name=\"CircleAlert\" color={colors.red} size={14}/>\n\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\tdataQA=\"error-message-text\"\n\t\t\t\t\t\t\tcolor={colors.red}\n\t\t\t\t\t\t\tid=\"file upload\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{errorMessage || \"Incorrect File Type\"}\n\t\t\t\t\t\t</Typography>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</ErrorMessageWrapper>\n\t\t</FileUploaderWrapper>\n\t);\n};\n\nexport default FileUploader;\n"]}